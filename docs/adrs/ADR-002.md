# ADR-002: Primary Language for Data-Related Tasks

## Context

[ADR-001](ADR-001.md) establishes TypeScript as the primary programming language for solutions built on the Dasolve framework. This ensures consistency for general-purpose application development (e.g., backend APIs, frontend UIs, business logic).

However, certain specialized domains have toolchains that are overwhelmingly standardized on a different language. For data-related tasks, specifically data engineering (Jobs) and Machine Learning (ML functions), the industry standard is Python. The ecosystem of libraries (e.g., Pandas, NumPy, Scikit-learn, PyTorch, TensorFlow) and platforms for these tasks is almost exclusively Python-based.

Forcing TypeScript for these specific tasks (as per Principle 1.2) would be counter-productive, requiring teams to:

1.  Use immature or non-existent JavaScript/TypeScript data libraries.
2.  Build and maintain complex "bridges" to shell out to Python scripts.
3.  Force data scientists and data engineers to work in an unfamiliar language, drastically reducing productivity.

This ADR defines a formal exception to ADR-001 to address this specific, high-value domain.

## Decision

**Python** is the primary programming language for **data-related tasks** (Jobs and Machine Learning functions) within solutions built on the Dasolve framework.

This decision applies to two specific categories of work:

1.  **Data Jobs:** This includes batch processing, ETL/ELT pipelines, data cleaning, data aggregation, and any asynchronous, heavy data-processing task.
2.  **Machine Learning Functions:** This includes all aspects of the ML lifecycle, such as data analysis, feature engineering, model training, model evaluation, and model inference (serving).

This ADR serves as a targeted exception to ADR-001.

- For all general application code (APIs, UIs, etc.), ADR-001 (TypeScript) applies.
- For the specific tasks defined above, this ADR (Python) takes precedence.

## Do's and Don'ts

This section clarifies the boundary between ADR-001 and ADR-002.

### Do

- **Do** use Python for all new code related to data processing jobs and ML model development/inference.
- **Do** leverage the mature Python data ecosystem (e.g., Pandas, Scikit-learn, PyTorch, TensorFlow, etc.).
- **Do** package Python code in a way that it can be invoked by the main TypeScript application (e.g., as a separate microservice, a serverless function, a containerized job, or a gRPC endpoint).
- **Do** maintain clear, well-defined API contracts between the TypeScript services and the Python services/jobs.

### Don't

- **Don't** use Python to build general-purpose backend APIs, frontend components, or business logic that is _not_ directly related to a data job or ML function. That remains the domain of TypeScript (per ADR-001).
- **Don't** attempt to use JavaScript/TypeScript libraries (e.g., TensorFlow.js) for heavy data manipulation or ML _training_ where a mature Python equivalent exists.
- **Don't** mix Python and TypeScript within the same service or codebase. Maintain a clear separation of concerns (e.g., a "TypeScript API service" that calls a "Python ML service").

## Consequences

- **Positive:**
  - We can leverage the entire, mature, industry-standard Python ecosystem for data science and ML.
  - Data scientists and data engineers can use the tools they are most proficient with, increasing productivity and attracting talent.
  - Enforces a clear separation of concerns: The core application logic (TypeScript) is decoupled from the specialized data processing logic (Python).
- **Negative:**
  - This officially introduces a "polyglot" (multi-language) architecture, which adds complexity to the ecosystem.
  - We must create and maintain build, test, and deployment pipelines for two different languages (TypeScript and Python).
  - Requires careful management of the "seam" or "bridge" (the API) between the TypeScript and Python components.
- **Risks:**
  - **Scope Creep:** Developers might be tempted to write general API logic in Python (e.g., using FastAPI or Django) simply because they are already in a Python service for an ML task. This must be vigilantly managed via code reviews.
  - **Boundary Confusion:** Teams may be unsure where the line is. The "Do's and Don'ts" section and code reviews are the primary mitigation for this.

## Compliance and Enforcement

- **Enforcement:** Compliance will be enforced through project structure and code reviews.
  - **Project Templates:** Solution templates provided by the Dasolve framework will have designated, separate directories/modules for Python-based data jobs and ML functions (e.g., `/data-jobs`, `/ml-models`), distinct from the core `/src` (TypeScript) application.
  - **Code Reviews:** Reviewers are responsible for ensuring this exception is not abused. They must verify that Python is used _only_ for its intended purpose (data and ML) and that all other logic remains in TypeScript as per ADR-001.
- **Exceptions:**
  - Any further exceptions (e.g., using a third language like 'R' for a specific statistical task, or using TypeScript for a simple ML inference task) must be explicitly approved by the Dasolve core team and documented as a new ADR.

## References

- [ADR-001: Primary Programming Language](./ADR-001.md)
- [Python Official Website](https://www.python.org/)
