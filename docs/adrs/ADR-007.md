# ADR-007: Supported Development Operating Systems

## Context

Our technology stack, as defined in previous ADRs, is built on modern, high-performance tools like `bun` ([ADR-003](./ADR-003.md), [ADR-005](./ADR-005.md)) and `uv` ([ADR-004](./ADR-004.md)). These tools are developed with a "Linux-first" (POSIX) mindset, prioritizing performance and compatibility with an environment that mirrors our production servers.

Running development in a non-POSIX environment (like native Windows) introduces significant risks and friction, including:

1.  **Tool Incompatibility:** Shell scripts (`.sh`), file paths (`/` vs `\`), and native dependencies for our chosen tools will fail or behave erratically.
2.  **Environment Divergence:** Developers working on different operating systems will encounter "it works on my machine" bugs that are difficult to reproduce and debug.
3.  **Production Parity:** Our production environments will be Linux. Developing in a non-Linux environment breaks the core DevOps principle of keeping development, staging, and production as similar as possible.
4.  **Documentation Overhead:** We would have to maintain parallel documentation and scripts for POSIX (`.sh`) and Windows (`.bat`, `.ps1`), increasing complexity.

We must standardize on a single, consistent environmental baseline for all developers to ensure stability and velocity.

## Decision

The officially supported operating systems for developing solutions on the Dasolve framework are **Linux** and **macOS**.

Developers using the **Windows** operating system **must** use the **Windows Subsystem for Linux (WSL)**, specifically **WSL 2 or newer**.

All development activities—including cloning the repository, running package managers, and executing the application—must be performed _from within_ the POSIX-compliant environment (i.e., the Linux/macOS/WSL 2 terminal).

## Do's and Don'ts

### Do

- **Do (Linux/macOS):** Develop natively. All tools will work as expected.
- **Do (Windows):**
  - Install and configure WSL 2 with a recommended Linux distribution (e.g., Ubuntu).
  - Clone your project repositories _directly into the WSL 2 filesystem_ (e.g., `/home/<user>/projects/`).
  - Run all development commands (`git`, `bun`, `uv`, `docker`) _from the WSL 2 terminal_.
  - Use an IDE with strong remote development support, such as **VS Code with the WSL 2 extension**, which connects the Windows UI to the tools and files running inside Linux.

### Don't

- **Don't (Windows):**
  - Do not run `bun`, `uv`, `git`, or any other development commands from native Windows (e.g., PowerShell, CMD).
  - Do not clone project repositories onto the Windows filesystem (e.g., `/mnt/c/Users/<user>/Projects/`). This causes severe performance degradation in WSL 2 and can lead to file permission and line-ending issues.
  - Do not write or commit Windows-specific scripts (e.g., `.bat`, `.ps1`) to the repository.

## Consequences

- **Positive:**

  - **Environment Parity:** All developers, regardless of their host OS, will be working in a consistent Linux-based environment. This directly mirrors our production (Linux) target.
  - **Tool Stability:** `bun`, `uv`, and all other chosen tools will function correctly and consistently for every developer.
  - **Simplified Documentation:** We only need to write and maintain one set of scripts (`.sh`) and setup instructions.
  - **Fewer Bugs:** This decision will eliminate an entire class of OS-specific bugs.

- **Negative:**

  - **Windows Onboarding Friction:** Windows developers face an extra, non-trivial setup step. They must install, configure, and learn to use WSL 2, which adds friction to their initial setup.
  - **IDE Configuration:** While VS Code's WSL integration is seamless, developers using other IDEs (like JetBrains) may face a more complex configuration process.

- **Risks:**
  - **Incorrect WSL Usage:** Developers may use WSL 2 incorrectly (e.g., cloning to `/mnt/c`), leading to frustration and a bad experience. This must be mitigated with clear documentation.
  - **WSL 2 Quirks:** We become dependent on Microsoft's WSL 2 technology, which can have its own bugs, networking quirks, or performance issues.

## Compliance and Enforcement

- **De Facto Enforcement:** This is largely self-enforcing. Our choice of `bun`, `uv`, and `.sh` scripts will simply fail to run on native Windows.
- **CI/CD Pipeline:** All CI/CD pipelines **must** run on **Linux** runners. This ensures that no Windows-specific code, configurations, or dependencies can be successfully built or merged.
- **Documentation:** All `README.md` files and developer onboarding guides **must** state this requirement as a prerequisite and link to this ADR. Clear, concise instructions for setting up WSL 2 must be provided.
- **Code Reviews:** Reviewers must reject any Windows-specific files (e.g., `.bat`, `.ps1`), scripts, or configuration changes.
